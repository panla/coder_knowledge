# 证书，密钥

公钥加密，私钥解密。私钥签名，公钥验证

## 自签名证书

```shell
# 生成 根 私钥
openssl genrsa -aes256 -out ca.key 2048

# 请求证书
openssl req -new -sha256 -key ca.key -out ca.csr

# 自签名根证书
openssl x509 -req -days 3650 -sha256 -extensions v3_ca -signkey ca.key -in ca.csr -out ca.cer

###

# 生成 服务端 私钥
openssl genrsa -aes256 -out server.key 2048

# 请求证书
openssl req -new -sha256 -key server.key -out server.csr

# 自签名服务端证书
openssl x509 -req -days 3650 -sha256 -extensions v3_req  -CA  ca.cer -CAkey ca.key  -CAserial ca.srl  -CAcreateserial -in server.csr -out server.cer

###

# 生成 客户端 私钥
openssl genrsa -aes256 -out server.key 2048

# 请求证书
openssl req -new -sha256 -key client.key -out client.csr

# 自签名 客户端 证书
openssl x509 -req -days 3650 -sha256 -extensions v3_req  -CA  ca.cer -CAkey ca.key  -CAserial ca.srl  -CAcreateserial -in client.csr -out client.cer
```

```text
Organization Name
Organizational Unit Name
Common Name 根，服务端，客户端，要有区分
```

## 证书转换

.key 转 .pem

```shell
openssl rsa -in xxx.key -out xxx.pem
```

## 校验

```shell
openssl verify -CAfile ca-cert.pem server-cert.pem client-cert.pem
```
