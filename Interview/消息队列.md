# 消息队列

[TOC]

## 1 消息队列消息顺序性

```text
RocketMQ 5.x 文档

    本身支持顺序消息，存在限制
    通过消息组判定和识别，
    发送顺序消息需要为每条消息设置归属的消息组，
    相同的消息组的多条消息之间遵循先进先出的顺序关系，
    不同消息组的消息之间不涉及顺序性

生产侧
    单一生产者：仅支持单一生产者
    串行发送：
        生产者客户端支持多线程安全访问，但是如果生产者使用多线程并行发送，
        不同线程间产生的消息，将无法判定先后顺序

消费侧
    通过消费者和服务端的协议保障消息消费严格按照存储的先后顺序来处理

    投递顺序
        MQ通过客户端SDK和服务端通信协议保障消息按照服务端存储顺序投递
        消费者消费消息时需要严格按照 接收-处理-应答来处理消息
        避免异步导致消息乱序
    有限重试
        限制重试次数，防止阻塞后续消息

消费建议
    串行消费，避免批量消费导致乱序
    消息组打散，避免集中导致热点
```

## 2 消息队列消息积压

```text
事前处理
    预估压力，增加机器，增加客户端消费
事中处理
    扩容消费者，增强消费能力
事后处理
    提高消费并行度
        极端一点，办公室里的电脑用做客户端

    批量方式消费

    跳过非重要消息消费

    优化每条消息消费过程

```

## 3 RabbitMQ

```text


```
