# 进程线程协程

[TOC]

## 0

- 进程是资源分配的最小单位，一个进程有一个或多个线程
- 线程是调度的最小单位，线程需要在进程内
- 协程则是用户态的线程，一个线程可以有一个或多个协程
- 协程拥有自己的寄存器上下文和栈，切换时，将其保存到其他地方，切换回来时再恢复，直接操作栈基本没有内核切换的开销
- 切换时的开销，进程 > 线程 > 协程

进程状态

- 创建，就绪，阻塞，运行，销毁

## 1 进程线程协程应用场景

- 需要发挥CPU多核的场景
- 进程用于计算密集型
- 线程可用于IO密集型
- 协程作为用户态线程用于IO密集型，异步

## 2 资源

### 2.1 进程资源

### 2.2 线程资源

## 3 线程从进程那里获得了什么

## 4 进程间通信

### 5.1 what

进程之间信息交换，传输

一个进程不能直接访问另一个进程地址空间，进程之间通信，必须要通过内核缓冲区

为什么要进程间通信

- 数据传输：一个进程需要将它的数据发给其他进程
- 资源共享：多个进程之间共享同样资源
- 通知事件：一个进程向其他进程发送消息，通知他们发生了某种事件
- 进程控制：一个进程去控制另一个进程执行

### 5.2 通信机制

- 管道
  - 存放在内存中的特殊文件，内核在内存中开辟缓冲区
- 消息队列
  - 管道效率低，
  - 消息队列时存放在内存中的消息的链表
- 共享内存
  - 消息队列速度较慢，数据读写需要经过用户态和内核态之间拷贝
  - 共享内存，两个进程的逻辑地址映射到物理空间的同一区域，所指向的区域是共享内存
- 信号量
  - 速度快，容易冲突
  - 信号量解决共享内存的互斥访问
- 信号
  - 进程通信机制中唯一的异步通信机制
- socket

## 6 线程安全

在拥有共享数据的多条线程并行执行的程序中，线程安全通过同步机制保护各线程正常执行

并发，原子性，可见性，有序性

- 原子性：
- 可见性：一个线程修改值后，其他线程能够立即知道
- 有序性：
